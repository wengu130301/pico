<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹æœºæ¨¡æ‹Ÿå™¨ Â· æ— ç§’åˆ·æ–°</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            background: #1a1a1a; 
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
            color: white;
        }
        #phone {
            width: 320px;
            height: 600px;
            border: 16px solid #333;
            border-radius: 36px;
            background: #000;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.6);
        }
        #screen {
            width: 100%;
            height: 100%;
            position: relative;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        #status-bar {
            height: 20px;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(2px);
            font-size: 12px;
            padding: 0 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            text-shadow: 0 1px 2px black;
            position: relative;
            z-index: 10;
        }
        .lock-screen, .home-screen, .app-screen, .poweroff-screen, .charging-screen, .boot-anim-screen {
            width: 100%;
            height: 100%;
            position: relative;
            background-size: cover;
            background-position: center;
            transition: background 0.3s ease;
        }
        .lock-screen, .home-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .lock-screen > div:first-child {
            font-size: 48px;
            font-weight: 300;
            text-shadow: 0 2px 10px rgba(0,0,0,0.7);
        }
        .lock-tip {
            margin-top: 50px;
            font-size: 14px;
            color: rgba(255,255,255,0.7);
            text-shadow: 0 1px 4px black;
        }
        .home-screen {
            padding-top: 20px;
            justify-content: flex-start;
        }
        .app-icon {
            width: 90%;
            margin: 0 auto 1px;
            height: 60px;
            line-height: 60px;
            text-align: center;
            font-size: 20px;
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(8px);
            border-radius: 16px;
            margin-bottom: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
            transition: 0.2s;
        }
        .app-icon:hover {
            background: rgba(255,255,255,0.25);
            transform: scale(0.98);
        }
        .wallpaper-text {
            position: absolute;
            bottom: 40px;
            width: 100%;
            text-align: center;
            font-size: 18px;
            color: white;
            text-shadow: 0 0 12px #000, 0 0 8px #000;
            letter-spacing: 1px;
        }
        #home-indicator {
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 4px;
            background: rgba(255,255,255,0.6);
            border-radius: 2px;
            z-index: 20;
            box-shadow: 0 0 6px black;
        }
        /* é€šç”¨åº”ç”¨ç•Œé¢æ ·å¼ */
        .app-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            overflow-y: auto;
        }
        .app-title {
            font-size: 28px;
            margin: 10px 0 20px;
            font-weight: 300;
        }
        .back-hint {
            font-size: 16px;
            color: #aaa;
            border: 1px solid #555;
            padding: 8px 24px;
            border-radius: 40px;
            background: rgba(0,0,0,0.3);
            margin-top: 20px;
            cursor: pointer;
            transition: 0.2s;
        }
        .back-hint:hover {
            background: rgba(255,255,255,0.1);
        }

        /* è®¾ç½®ç•Œé¢ä¸“ç”¨æ ·å¼ */
        .settings-section {
            width: 100%;
            padding: 0 15px;
            margin-bottom: 20px;
        }
        .section-title {
            font-size: 20px;
            color: #ddd;
            margin-bottom: 10px;
            padding-left: 5px;
            border-left: 4px solid #4caf50;
        }
        .update-card {
            background: rgba(30,30,30,0.8);
            backdrop-filter: blur(5px);
            border-radius: 24px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #444;
        }
        .version-row {
            display: flex;
            justify-content: space-between;
            font-size: 18px;
            margin: 8px 0;
        }
        .version-label {
            color: #aaa;
        }
        .version-value {
            font-family: monospace;
            font-size: 20px;
            color: #4caf50;
        }
        .update-btn {
            width: 100%;
            background: #2e7d32;
            border: none;
            border-radius: 30px;
            padding: 12px;
            color: white;
            font-size: 18px;
            margin-top: 15px;
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid #1b5e20;
        }
        .update-btn:active {
            background: #1b5e20;
        }
        .update-btn.disabled {
            background: #555;
            border-color: #444;
            cursor: not-allowed;
            opacity: 0.5;
        }
        .wallpaper-panel {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            background: rgba(30,30,30,0.9);
            backdrop-filter: blur(10px);
            border-radius: 28px;
            margin: 10px 0;
            border: 1px solid #444;
        }
        .wallpaper-option {
            width: 80px;
            height: 120px;
            border-radius: 16px;
            border: 3px solid transparent;
            transition: 0.2s;
            cursor: pointer;
            box-shadow: 0 8px 16px black;
            background-size: cover;
            background-position: center;
        }
        .wallpaper-option:hover {
            transform: scale(1.05);
            border-color: white;
        }
        .wallpaper-option.selected {
            border-color: #4caf50;
            box-shadow: 0 0 0 2px #4caf50;
        }
        .wallpaper-label {
            text-align: center;
            color: #ddd;
            font-size: 14px;
            margin-top: 6px;
        }
        .wp-dark { background: #121212; }
        .wp-blue { background: linear-gradient(145deg, #1e3c72, #2a5298); }
        .wp-green { background: linear-gradient(145deg, #134e5e, #71b280); }
        .wp-purple { background: linear-gradient(145deg, #373b44, #4286f4); }

        /* ========== ç”µè¯æ‹¨å·ç›˜ ========== */
        .dialer-container {
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 10px;
        }
        .number-display {
            width: 100%;
            background: rgba(0,0,0,0.4);
            border-radius: 30px;
            padding: 20px 20px;
            margin: 10px 0 20px;
            text-align: center;
            font-size: 32px;
            letter-spacing: 2px;
            color: white;
            border: 1px solid #555;
            font-family: monospace;
            overflow-x: auto;
            white-space: nowrap;
        }
        .number-display.empty {
            color: #aaa;
            font-size: 24px;
        }
        .dialpad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            width: 100%;
            max-width: 260px;
            margin: 0 auto;
        }
        .dial-btn {
            aspect-ratio: 1 / 1;
            border-radius: 50%;
            background: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            font-size: 28px;
            font-weight: 400;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.15s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            user-select: none;
        }
        .dial-btn:active {
            transform: scale(0.9);
            background: rgba(255,255,255,0.3);
        }
        .action-row {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 260px;
            margin-top: 20px;
            gap: 20px;
        }
        .action-btn {
            flex: 1;
            padding: 12px 0;
            border-radius: 40px;
            background: rgba(255,255,255,0.1);
            border: 1px solid #555;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: 0.2s;
            text-align: center;
        }
        .action-btn.call {
            background: #2e7d32;
            border-color: #1b5e20;
        }
        .action-btn.delete {
            background: #b71c1c;
            border-color: #8b0000;
        }
        .action-btn:active {
            opacity: 0.7;
        }
        /* æ— SIMå¡æç¤º */
        .sim-toast {
            background: rgba(0,0,0,0.8);
            color: #ff8a80;
            padding: 10px 20px;
            border-radius: 30px;
            margin-top: 10px;
            font-size: 14px;
            border: 1px solid #ff8a80;
            animation: fadeOut 2s forwards;
        }
        @keyframes fadeOut {
            0% { opacity: 1; }
            70% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* ========== çŸ­ä¿¡ç•Œé¢ ========== */
        .sms-container {
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 0 12px;
        }
        .message-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .message {
            max-width: 80%;
            padding: 10px 14px;
            border-radius: 20px;
            font-size: 14px;
            word-wrap: break-word;
        }
        .message.received {
            align-self: flex-start;
            background: #333;
            border-bottom-left-radius: 4px;
        }
        .message.sent {
            align-self: flex-end;
            background: #0b7b4c;
            border-bottom-right-radius: 4px;
        }
        .sms-input-area {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        .sms-input-area input {
            flex: 1;
            padding: 12px 16px;
            border-radius: 30px;
            border: 1px solid #555;
            background: #222;
            color: white;
            font-size: 16px;
            outline: none;
        }
        .sms-input-area input::placeholder {
            color: #888;
        }
        .send-btn {
            background: #0b7b4c;
            border: none;
            border-radius: 30px;
            padding: 0 20px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: 0.2s;
        }
        .send-btn:active {
            background: #0a5e3a;
        }

        /* ========== è®¡ç®—å™¨ ========== */
        .calculator {
            width: 100%;
            padding: 10px;
        }
        .calc-display {
            width: 100%;
            background: #1e1e1e;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: right;
            font-size: 36px;
            font-family: monospace;
            border: 1px solid #444;
            overflow-x: auto;
            white-space: nowrap;
        }
        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        .calc-btn {
            aspect-ratio: 1 / 1;
            border-radius: 20px;
            background: #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            border: 1px solid #444;
            transition: 0.1s;
            user-select: none;
        }
        .calc-btn.operator {
            background: #ff9500;
            color: white;
        }
        .calc-btn.equals {
            background: #ff9500;
            grid-column: span 2;
            aspect-ratio: auto;
        }
        .calc-btn.clear {
            background: #a6a6a6;
            color: black;
        }
        .calc-btn:active {
            transform: scale(0.95);
            opacity: 0.8;
        }

        /* ========== æ—¶é’Ÿï¼ˆæ— ç§’ï¼‰ ========== */
        .clock-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }
        .digital-clock {
            font-size: 48px;
            font-family: monospace;
            background: rgba(0,0,0,0.4);
            padding: 20px 25px;
            border-radius: 40px;
            border: 1px solid #555;
            letter-spacing: 4px;
        }
        .clock-date {
            font-size: 20px;
            margin-top: 20px;
            color: #ccc;
        }

        /* ========== å…³æœº/å……ç”µç•Œé¢ ========== */
        .poweroff-screen, .charging-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #0a0a0a;
            color: white;
            padding: 20px;
        }
        .battery-icon {
            width: 80px;
            height: 40px;
            border: 3px solid white;
            border-radius: 8px;
            position: relative;
            margin: 30px 0 20px;
        }
        .battery-icon::after {
            content: '';
            position: absolute;
            right: -8px;
            top: 10px;
            width: 5px;
            height: 14px;
            background: white;
            border-radius: 2px;
        }
        .battery-level {
            height: 100%;
            background: #4caf50;
            border-radius: 4px;
            width: 0%;
        }
        .poweroff-title {
            font-size: 24px;
            margin-bottom: 30px;
            color: #ff8a80;
        }
        .poweroff-buttons {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }
        .poweroff-btn {
            padding: 12px 30px;
            border-radius: 40px;
            background: #333;
            color: white;
            border: 1px solid #666;
            font-size: 18px;
            cursor: pointer;
            transition: 0.2s;
        }
        .poweroff-btn.charge {
            background: #2e7d32;
            border-color: #1b5e20;
        }
        .poweroff-btn:hover {
            opacity: 0.8;
        }
        .charging-percent {
            font-size: 48px;
            font-family: monospace;
            margin: 20px 0;
        }
        .charging-text {
            font-size: 24px;
            margin-bottom: 40px;
        }
        .hint-text {
            color: #aaa;
            font-size: 14px;
            margin-top: 10px;
        }

        /* ========== å¼€æœºåŠ¨ç”» ========== */
        .boot-anim-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #000;
            color: white;
            font-size: 48px;
            font-weight: bold;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        .boot-anim-screen span {
            font-size: 24px;
            margin-top: 20px;
            color: #888;
        }
    </style>
</head>
<body>
    <div id="phone">
        <div id="screen"></div>
        <div id="home-indicator"></div>
    </div>

    <script>
        class AndroidPico {
            constructor() {
                this.screen = "lock";                 // lock, home, app, poweroff, charging, bootanim
                this.current_app = 0;                   // å½“å‰æ‰“å¼€çš„åº”ç”¨ç´¢å¼•
                this.lastTouchTime = 0;
                this.doubleClickThreshold = 300;

                // åº”ç”¨åˆ—è¡¨
                this.apps = ["è®¾ç½®", "ç”µè¯", "çŸ­ä¿¡", "è®¡ç®—å™¨", "æ—¶é’Ÿ"];

                // å£çº¸ç›¸å…³
                this.wallpaper = 0;                      // 0:æ·±è‰²,1:è“,2:ç»¿,3:ç´«
                this.wallpaperText = "æ–°å¹´å¿«ä¹ï¼";
                this.wallpapers = [
                    "background: #121212;",                                 // æ·±è‰²çº¯è‰²
                    "background: linear-gradient(145deg, #1e3c72, #2a5298);", // è“è‰²æ¸å˜
                    "background: linear-gradient(145deg, #134e5e, #71b280);", // ç»¿è‰²æ¸å˜
                    "background: linear-gradient(145deg, #373b44, #4286f4);"  // ç´«è“æ¸å˜
                ];

                // æ‹¨å·ç›¸å…³
                this.dialNumber = "";                    // å½“å‰è¾“å…¥çš„å·ç 
                this.showCallToast = false;               // ç”µè¯æ— SIMå¡æç¤º

                // çŸ­ä¿¡ç›¸å…³
                this.smsInput = "";                       // å½“å‰è¾“å…¥æ¡†å†…å®¹
                this.showSmsToast = false;                 // çŸ­ä¿¡æ— SIMå¡æç¤º
                this.messages = [
                    { type: 'received', text: 'æ˜å¤©ä¸€èµ·åƒé¥­å—ï¼Ÿ' },
                    { type: 'sent', text: 'å¥½å•Šï¼Œå‡ ç‚¹ï¼Ÿ' },
                    { type: 'received', text: 'æ™šä¸Šä¸ƒç‚¹å¦‚ä½•ï¼Ÿ' }
                ];

                // è®¡ç®—å™¨ç›¸å…³
                this.calcExpression = "";                  // å½“å‰è®¡ç®—å™¨è¡¨è¾¾å¼

                // ç”µæ± ä¸å……ç”µ
                this.battery = 98;                          // åˆå§‹ç”µé‡
                this.charging = false;                      // æ˜¯å¦æ­£åœ¨å……ç”µ

                // ç‰ˆæœ¬æ›´æ–°ç›¸å…³
                this.currentVersion = 2.0;                  // å½“å‰ç³»ç»Ÿç‰ˆæœ¬
                this.latestVersion = 2.0;                    // æœ€æ–°å¯ç”¨ç‰ˆæœ¬ï¼ˆæ¯åˆ†é’Ÿ+0.1ï¼‰

                // å¼€æœºåŠ¨ç”»å®šæ—¶å™¨
                this.bootTimer = null;

                this.screenEl = document.getElementById('screen');
                this.screenEl.addEventListener('click', (e) => this.onGlobalClick(e));

                // æ¯åˆ†é’Ÿæ›´æ–°ç”µé‡ã€ç‰ˆæœ¬å·å¹¶åˆ·æ–°ç•Œé¢ï¼ˆå–ä»£æ¯ç§’åˆ·æ–°ï¼‰
                setInterval(() => {
                    if (this.charging) {
                        // å……ç”µçŠ¶æ€ï¼šç”µé‡å¢åŠ ï¼Œä¸è¶…è¿‡100
                        if (this.battery < 100) {
                            this.battery++;
                        }
                    } else {
                        // éå……ç”µçŠ¶æ€ï¼šç”µé‡å‡å°‘ï¼Œä¸ä½äº0
                        if (this.battery > 0) {
                            this.battery--;
                        }
                    }

                    // æœ€æ–°ç‰ˆæœ¬æ¯åˆ†é’Ÿå¢åŠ 0.1ï¼ˆä¿ç•™ä¸€ä½å°æ•°ï¼‰
                    this.latestVersion = Math.round((this.latestVersion + 0.1) * 10) / 10;

                    // æ£€æŸ¥æ˜¯å¦éœ€è¦è‡ªåŠ¨å…³æœºï¼ˆç”µé‡â‰¤0ä¸”ä¸åœ¨å……ç”µçŠ¶æ€ï¼Œä¸”å½“å‰ä¸æ˜¯å…³æœº/å……ç”µç•Œé¢ï¼‰
                    if (this.battery <= 0 && !this.charging && this.screen !== "poweroff" && this.screen !== "charging") {
                        this.powerOff();
                    } else {
                        // å¦åˆ™æ­£å¸¸æ¸²æŸ“
                        this.renderUI();
                    }
                }, 60000); // æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡

                this.renderUI();
            }

            // çŠ¶æ€æ åªæ˜¾ç¤ºæ—¶:åˆ†ï¼Œæ— ç§’
            getStatusBar() {
                const now = new Date();
                const time = now.getHours().toString().padStart(2, '0') + ":" + 
                             now.getMinutes().toString().padStart(2, '0');
                return `${time} | ğŸ“¶ | ğŸ”‹${this.battery}%`;
            }

            getWallpaperStyle() {
                return this.wallpapers[this.wallpaper] || this.wallpapers[0];
            }

            openApp(index) {
                this.current_app = index;
                this.screen = "app";
                this.renderUI();
            }

            goHome() {
                this.screen = "home";
                this.renderUI();
            }

            lockScreen() {
                this.screen = "lock";
                this.renderUI();
            }

            // æ‰‹åŠ¨å…³æœº
            manualPowerOff() {
                this.screen = "poweroff";
                this.renderUI();
            }

            // è‡ªåŠ¨å…³æœºï¼ˆç”µé‡è€—å°½è§¦å‘ï¼‰
            powerOff() {
                this.screen = "poweroff";
                this.charging = false;  // å…³æœºæ—¶åœæ­¢å……ç”µ
                this.renderUI();
            }

            // å¼€å§‹å……ç”µï¼ˆä»å…³æœºç•Œé¢ç‚¹å‡»å……ç”µï¼‰
            startCharging() {
                this.charging = true;
                this.screen = "charging";
                this.renderUI();
            }

            // æ™®é€šå¼€æœºï¼ˆä»å……ç”µç•Œé¢æˆ–å…³æœºç•Œé¢ç‚¹å‡»å¼€æœºï¼‰ï¼Œæ’­æ”¾åŠ¨ç”»åè¿›å…¥é”å±
            boot() {
                // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨ï¼Œé˜²æ­¢å¤šä¸ªåŠ¨ç”»é‡å 
                if (this.bootTimer) {
                    clearTimeout(this.bootTimer);
                    this.bootTimer = null;
                }

                this.screen = "bootanim";
                this.renderUI();

                // 2ç§’ååˆ‡æ¢åˆ°é”å±
                this.bootTimer = setTimeout(() => {
                    this.screen = "lock";
                    this.renderUI();
                    this.bootTimer = null;
                }, 2000);
            }

            // æ‰§è¡Œç³»ç»Ÿæ›´æ–°ï¼ˆå¸¦é‡å¯åŠ¨ç”»ï¼‰
            performUpdate() {
                if (this.latestVersion > this.currentVersion) {
                    // æ¸…é™¤å·²æœ‰åŠ¨ç”»å®šæ—¶å™¨
                    if (this.bootTimer) {
                        clearTimeout(this.bootTimer);
                        this.bootTimer = null;
                    }

                    // è¿›å…¥é‡å¯åŠ¨ç”»
                    this.screen = "bootanim";
                    this.renderUI();

                    // 2ç§’åå®Œæˆæ›´æ–°å¹¶è¿›å…¥é”å±
                    this.bootTimer = setTimeout(() => {
                        this.currentVersion = this.latestVersion; // æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
                        this.screen = "lock";
                        this.renderUI();
                        this.bootTimer = null;
                    }, 2000);
                }
            }

            setWallpaper(index) {
                if (index >= 0 && index < this.wallpapers.length) {
                    this.wallpaper = index;
                }
                // æ›´æ–°å£çº¸åç•™åœ¨è®¾ç½®ç•Œé¢ï¼Œä¸è‡ªåŠ¨è¿”å›ä¸»å±
                this.renderUI();
            }

            // ========== ç”µè¯åŠŸèƒ½ ==========
            appendDigit(digit) {
                this.dialNumber += digit;
                this.renderUI();
            }

            deleteDigit() {
                if (this.dialNumber.length > 0) {
                    this.dialNumber = this.dialNumber.slice(0, -1);
                    this.renderUI();
                }
            }

            call() {
                this.showCallToast = true;
                this.dialNumber = '';   // æ¸…ç©ºå·ç 
                this.renderUI();
                setTimeout(() => {
                    this.showCallToast = false;
                    if (this.screen === "app" && this.current_app === 1) {
                        this.renderUI();
                    }
                }, 2000);
            }

            // ========== çŸ­ä¿¡åŠŸèƒ½ ==========
            updateSmsInput(value) {
                this.smsInput = value;
            }

            sendSms() {
                if (!this.smsInput.trim()) return;
                this.showSmsToast = true;
                this.smsInput = '';
                this.renderUI();
                setTimeout(() => {
                    this.showSmsToast = false;
                    if (this.screen === "app" && this.current_app === 2) {
                        this.renderUI();
                    }
                }, 2000);
            }

            // ========== è®¡ç®—å™¨ ==========
            handleCalcButton(val) {
                if (val === 'C') {
                    this.calcExpression = '';
                } else if (val === '=') {
                    try {
                        const result = new Function('return ' + this.calcExpression)();
                        this.calcExpression = String(result);
                    } catch {
                        this.calcExpression = 'é”™è¯¯';
                    }
                } else {
                    if (this.calcExpression === 'é”™è¯¯') {
                        this.calcExpression = '';
                    }
                    this.calcExpression += val;
                }
                this.renderUI();
            }

            // ========== å…¨å±€äº‹ä»¶ ==========
            onGlobalClick(e) {
                const now = Date.now();

                // å¦‚æœæ­£åœ¨æ’­æ”¾å¼€æœºåŠ¨ç”»ï¼Œå¿½ç•¥æ‰€æœ‰ç‚¹å‡»
                if (this.screen === "bootanim") {
                    return;
                }

                // åŒå‡»é”å±ï¼ˆä»…åœ¨ä¸»å±æˆ–åº”ç”¨ç•Œé¢ç”Ÿæ•ˆï¼‰
                if (now - this.lastTouchTime < this.doubleClickThreshold) {
                    if (this.screen === "home" || this.screen === "app") {
                        this.lockScreen();
                    }
                    this.lastTouchTime = 0;
                    return;
                }

                this.lastTouchTime = now;

                // å•å‡»é”å± -> è§£é”
                if (this.screen === "lock") {
                    this.goHome();
                }
                // å…¶ä»–ç•Œé¢å•å‡»ç”±å†…éƒ¨æŒ‰é’®å¤„ç†
            }

            // ========== æ¸²æŸ“ ==========
            renderUI() {
                let html = '';
                const statusBar = `<div id="status-bar">${this.getStatusBar()}</div>`;

                switch (this.screen) {
                    case "lock": {
                        const now = new Date();
                        const lockTime = now.getHours().toString().padStart(2, '0') + ":" + 
                                         now.getMinutes().toString().padStart(2, '0');
                        html = `
                            <div class="lock-screen" style="${this.getWallpaperStyle()}">
                                <div>${lockTime}</div>
                                <div class="lock-tip">å•å‡»è§£é” Â· åŒå‡»é”å±</div>
                                <div class="wallpaper-text">${this.wallpaperText}</div>
                            </div>
                        `;
                        break;
                    }

                    case "home": {
                        html = `
                            ${statusBar}
                            <div class="home-screen" style="${this.getWallpaperStyle()}">
                                <div class="app-icon" data-app="0">è®¾ç½®</div>
                                <div class="app-icon" data-app="1">ç”µè¯</div>
                                <div class="app-icon" data-app="2">çŸ­ä¿¡</div>
                                <div class="app-icon" data-app="3">è®¡ç®—å™¨</div>
                                <div class="app-icon" data-app="4">æ—¶é’Ÿ</div>
                                <!-- æ‰‹åŠ¨å…³æœºå›¾æ ‡ -->
                                <div class="app-icon" data-action="poweroff">â» å…³æœº</div>
                                <div class="wallpaper-text">${this.wallpaperText}</div>
                            </div>
                        `;
                        break;
                    }

                    case "app": {
                        // è®¾ç½®åº”ç”¨ (åŒ…å«ç‰ˆæœ¬æ›´æ–°å’Œå£çº¸)
                        if (this.current_app === 0) {
                            // æ„å»ºå£çº¸é€‰é¡¹
                            const wallpapersPreview = [
                                { class: 'wp-dark', label: 'æ·±ç©ºé»‘' },
                                { class: 'wp-blue', label: 'æ·±æµ·è“' },
                                { class: 'wp-green', label: 'æ£®æ—ç»¿' },
                                { class: 'wp-purple', label: 'æå…‰ç´«' }
                            ];
                            let wallpaperOptions = '';
                            wallpapersPreview.forEach((wp, idx) => {
                                const selectedClass = (this.wallpaper === idx) ? 'selected' : '';
                                wallpaperOptions += `
                                    <div style="text-align:center;">
                                        <div class="wallpaper-option ${wp.class} ${selectedClass}" 
                                             data-wallpaper="${idx}"></div>
                                        <div class="wallpaper-label">${wp.label}</div>
                                    </div>
                                `;
                            });

                            // ç‰ˆæœ¬æ›´æ–°å¡ç‰‡
                            const hasUpdate = this.latestVersion > this.currentVersion;
                            const updateButton = hasUpdate 
                                ? '<button class="update-btn" data-action="update">ç«‹å³æ›´æ–°</button>'
                                : '<button class="update-btn disabled" disabled>å·²æ˜¯æœ€æ–°ç‰ˆæœ¬</button>';

                            html = `
                                ${statusBar}
                                <div class="app-screen">
                                    <div class="app-title">è®¾ç½®</div>
                                    
                                    <!-- ç³»ç»Ÿæ›´æ–°å¡ç‰‡ -->
                                    <div class="settings-section">
                                        <div class="section-title">ç³»ç»Ÿæ›´æ–°</div>
                                        <div class="update-card">
                                            <div class="version-row">
                                                <span class="version-label">å½“å‰ç‰ˆæœ¬</span>
                                                <span class="version-value">WOS ${this.currentVersion.toFixed(1)}</span>
                                            </div>
                                            <div class="version-row">
                                                <span class="version-label">æœ€æ–°ç‰ˆæœ¬</span>
                                                <span class="version-value">WOS ${this.latestVersion.toFixed(1)}</span>
                                            </div>
                                            ${updateButton}
                                        </div>
                                    </div>

                                    <!-- å£çº¸é€‰æ‹© -->
                                    <div class="settings-section">
                                        <div class="section-title">å£çº¸é€‰æ‹©</div>
                                        <div class="wallpaper-panel">
                                            ${wallpaperOptions}
                                        </div>
                                    </div>

                                    <div class="back-hint" data-home="true">è¿”å›ä¸»å±</div>
                                </div>
                            `;
                        } 
                        // ç”µè¯
                        else if (this.current_app === 1) {
                            const numberDisplayClass = this.dialNumber ? '' : 'empty';
                            const displayText = this.dialNumber || 'è¾“å…¥å·ç ';
                            const digits = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '*', '0', '#'];
                            let dialpadHtml = '';
                            digits.forEach(d => {
                                dialpadHtml += `<div class="dial-btn" data-digit="${d}">${d}</div>`;
                            });
                            const toastHtml = this.showCallToast ? '<div class="sim-toast">âš ï¸ æ— SIMå¡ï¼Œæ— æ³•æ‹¨å·</div>' : '';

                            html = `
                                ${statusBar}
                                <div class="app-screen" style="justify-content: flex-start;">
                                    <div class="app-title">ç”µè¯</div>
                                    <div class="dialer-container">
                                        <div class="number-display ${numberDisplayClass}">${displayText}</div>
                                        <div class="dialpad">
                                            ${dialpadHtml}
                                        </div>
                                        <div class="action-row">
                                            <div class="action-btn delete" data-action="delete">âŒ« åˆ é™¤</div>
                                            <div class="action-btn call" data-action="call">ğŸ“ å‘¼å«</div>
                                        </div>
                                        ${toastHtml}
                                        <div class="back-hint" data-home="true" style="margin-top:15px;">è¿”å›ä¸»å±</div>
                                    </div>
                                </div>
                            `;
                        } 
                        // çŸ­ä¿¡
                        else if (this.current_app === 2) {
                            let messagesHtml = '';
                            this.messages.forEach(msg => {
                                messagesHtml += `<div class="message ${msg.type}">${msg.text}</div>`;
                            });
                            const toastHtml = this.showSmsToast ? '<div class="sim-toast">âš ï¸ æ— SIMå¡ï¼Œæ— æ³•å‘é€çŸ­ä¿¡</div>' : '';

                            html = `
                                ${statusBar}
                                <div class="app-screen" style="justify-content: flex-start;">
                                    <div class="app-title">çŸ­ä¿¡</div>
                                    <div class="sms-container">
                                        <div class="message-list">
                                            ${messagesHtml}
                                        </div>
                                        <div class="sms-input-area">
                                            <input type="text" id="sms-input" placeholder="è¾“å…¥æ¶ˆæ¯" value="${this.smsInput.replace(/"/g, '&quot;')}">
                                            <button class="send-btn" id="send-sms-btn">å‘é€</button>
                                        </div>
                                        ${toastHtml}
                                        <div class="back-hint" data-home="true" style="margin-top:15px;">è¿”å›ä¸»å±</div>
                                    </div>
                                </div>
                            `;
                        } 
                        // è®¡ç®—å™¨
                        else if (this.current_app === 3) {
                            const displayText = this.calcExpression || '0';
                            html = `
                                ${statusBar}
                                <div class="app-screen">
                                    <div class="app-title">è®¡ç®—å™¨</div>
                                    <div class="calculator">
                                        <div class="calc-display">${displayText}</div>
                                        <div class="calc-buttons">
                                            <div class="calc-btn" data-calc="7">7</div>
                                            <div class="calc-btn" data-calc="8">8</div>
                                            <div class="calc-btn" data-calc="9">9</div>
                                            <div class="calc-btn operator" data-calc="/">Ã·</div>
                                            <div class="calc-btn" data-calc="4">4</div>
                                            <div class="calc-btn" data-calc="5">5</div>
                                            <div class="calc-btn" data-calc="6">6</div>
                                            <div class="calc-btn operator" data-calc="*">Ã—</div>
                                            <div class="calc-btn" data-calc="1">1</div>
                                            <div class="calc-btn" data-calc="2">2</div>
                                            <div class="calc-btn" data-calc="3">3</div>
                                            <div class="calc-btn operator" data-calc="-">âˆ’</div>
                                            <div class="calc-btn" data-calc="0">0</div>
                                            <div class="calc-btn" data-calc=".">.</div>
                                            <div class="calc-btn clear" data-calc="C">C</div>
                                            <div class="calc-btn operator" data-calc="+">+</div>
                                            <div class="calc-btn equals" data-calc="=">=</div>
                                        </div>
                                    </div>
                                    <div class="back-hint" data-home="true" style="margin-top:20px;">è¿”å›ä¸»å±</div>
                                </div>
                            `;
                        } 
                        // æ—¶é’Ÿï¼ˆæ— ç§’ï¼‰
                        else if (this.current_app === 4) {
                            const now = new Date();
                            const year = now.getFullYear();
                            const month = (now.getMonth()+1).toString().padStart(2,'0');
                            const day = now.getDate().toString().padStart(2,'0');
                            const hours = now.getHours().toString().padStart(2,'0');
                            const minutes = now.getMinutes().toString().padStart(2,'0');
                            const dateStr = `${year}-${month}-${day}`;
                            const timeStr = `${hours}:${minutes}`; // æ— ç§’

                            html = `
                                ${statusBar}
                                <div class="app-screen">
                                    <div class="app-title">æ—¶é’Ÿ</div>
                                    <div class="clock-container">
                                        <div class="digital-clock">${timeStr}</div>
                                        <div class="clock-date">${dateStr}</div>
                                    </div>
                                    <div class="back-hint" data-home="true" style="margin-top:40px;">è¿”å›ä¸»å±</div>
                                </div>
                            `;
                        }
                        break;
                    }

                    // å…³æœºç•Œé¢
                    case "poweroff": {
                        const batteryPercent = this.battery; 
                        html = `
                            <div class="poweroff-screen">
                                <div class="poweroff-title">âš ï¸ æ‰‹æœºå·²å…³æœº</div>
                                <div class="battery-icon">
                                    <div class="battery-level" style="width:${batteryPercent}%;"></div>
                                </div>
                                <div style="font-size:20px; margin:10px 0;">${batteryPercent}%</div>
                                <div class="poweroff-buttons">
                                    <div class="poweroff-btn charge" data-action="charge">ğŸ”‹ å……ç”µ</div>
                                    <div class="poweroff-btn" data-action="boot">ğŸ”› å¼€æœº</div>
                                </div>
                                <div class="hint-text">å……ç”µæ¯åˆ†é’Ÿå¢åŠ 1%ç”µé‡</div>
                            </div>
                        `;
                        break;
                    }

                    // å……ç”µç•Œé¢
                    case "charging": {
                        const batteryPercent = this.battery;
                        const fullText = batteryPercent >= 100 ? 'å·²å……æ»¡' : 'æ­£åœ¨å……ç”µ...';
                        html = `
                            <div class="charging-screen">
                                <div class="battery-icon">
                                    <div class="battery-level" style="width:${batteryPercent}%;"></div>
                                </div>
                                <div class="charging-percent">${batteryPercent}%</div>
                                <div class="charging-text">${fullText}</div>
                                <div class="poweroff-buttons">
                                    <div class="poweroff-btn" data-action="boot">ğŸ”› å¼€æœº</div>
                                </div>
                                <div class="hint-text">ç”µé‡æ¯åˆ†é’Ÿå¢åŠ 1%</div>
                            </div>
                        `;
                        break;
                    }

                    // å¼€æœºåŠ¨ç”»
                    case "bootanim": {
                        html = `
                            <div class="boot-anim-screen">
                                <div>wPhone</div>
                                <span>Starting...</span>
                            </div>
                        `;
                        break;
                    }
                }

                this.screenEl.innerHTML = html;
                this.attachEvents();
            }

            attachEvents() {
                // ä¸»å±åº”ç”¨å›¾æ ‡ (å¸¸è§„åº”ç”¨)
                document.querySelectorAll('.app-icon[data-app]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const idx = parseInt(el.getAttribute('data-app'), 10);
                        this.openApp(idx);
                    });
                });

                // æ‰‹åŠ¨å…³æœºå›¾æ ‡
                document.querySelectorAll('[data-action="poweroff"]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.manualPowerOff();
                    });
                });

                // è¿”å›ä¸»å± (æ‰€æœ‰å¸¦æœ‰ data-home çš„å…ƒç´ )
                document.querySelectorAll('[data-home]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.goHome();
                    });
                });

                // å£çº¸é€‰é¡¹
                document.querySelectorAll('.wallpaper-option[data-wallpaper]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const wpIdx = parseInt(el.getAttribute('data-wallpaper'), 10);
                        this.setWallpaper(wpIdx);
                    });
                });

                // ç‰ˆæœ¬æ›´æ–°æŒ‰é’®
                document.querySelectorAll('[data-action="update"]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.performUpdate();
                    });
                });

                // ç”µè¯æ‹¨å·ç›˜æ•°å­—é”®
                document.querySelectorAll('.dial-btn[data-digit]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const digit = el.getAttribute('data-digit');
                        this.appendDigit(digit);
                    });
                });

                // ç”µè¯åˆ é™¤/å‘¼å«
                document.querySelectorAll('[data-action="delete"]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.deleteDigit();
                    });
                });
                document.querySelectorAll('[data-action="call"]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.call();
                    });
                });

                // çŸ­ä¿¡è¾“å…¥æ¡†
                const smsInput = document.getElementById('sms-input');
                if (smsInput) {
                    smsInput.addEventListener('input', (e) => {
                        this.smsInput = e.target.value;
                    });
                }
                // å‘é€æŒ‰é’®
                const sendBtn = document.getElementById('send-sms-btn');
                if (sendBtn) {
                    sendBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.sendSms();
                    });
                }

                // è®¡ç®—å™¨æŒ‰é’®
                document.querySelectorAll('[data-calc]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const val = el.getAttribute('data-calc');
                        this.handleCalcButton(val);
                    });
                });

                // å…³æœºç•Œé¢æŒ‰é’®ï¼šå……ç”µ
                document.querySelectorAll('[data-action="charge"]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.startCharging();
                    });
                });
                // å¼€æœºæŒ‰é’®ï¼ˆå…³æœºç•Œé¢å’Œå……ç”µç•Œé¢å…±ç”¨ï¼‰
                document.querySelectorAll('[data-action="boot"]').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.boot();
                    });
                });
            }
        }

        let pico;
        window.onload = () => {
            pico = new AndroidPico();
        };
    </script>
</body>
</html>